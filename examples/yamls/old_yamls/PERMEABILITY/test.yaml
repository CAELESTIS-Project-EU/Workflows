workflow_type: PERMEABILITY
phases:
  sampler:
    type: permeability_sampler
    input:
      - sampler_input_file: $sampler_input_file
    parameters: 
      - problem: $problem
  sim:
    type: alya
    outputs: 
      - alya_output: $alya-output
    inputs: 
      - mesh: $mesh
      - template_sld: $template_sld
      - template_dom: $template_dom
    parameters: 
      - cpus: 128
outputs:
  alya-output: 
    - path: alya_output.txt
    - server: "ftp://nas.aimen.es/P_CAELESTIS_SHARE/outputs/test24Nov"
    - overwrite: true
inputs:
  mesh: 
    - server: "ftp://nas.aimen.es/P_CAELESTIS_SHARE/input/meshes/FEM_OHT_nom"
    - path: "meshes/FEM_OHT_nom"
  template_sld: 
    - server: "ftp://nas.aimen.es/P_CAELESTIS_SHARE/input/templates/FEM_OHT_nom-tem.sld.dat"
    - path: "templates/FEM_OHT_nom-tem.sld.dat"
  template_dom: 
    - server: "ftp://nas.aimen.es/P_CAELESTIS_SHARE/input/templates/FEM_OHT_nom-tem.dom.dat"
    - path: "templates/FEM_OHT_nom-tem.dom.dat"
  sampler_input_file:
    - server: "ftp://nas.aimen.es/P_CAELESTIS_SHARE/input/samplers/doe_seed.txt"
    - path: "sampler/doe_seed.txt"
parameters:
  problem:
    - density: 1.1e+3      # density of the fluid (kg/m3)
    - viscosity: 3.5e-2      # viscosity of the fluid(kg/(m·s))
    - volume_fraction: 0.6   # fiber volume fraction
    - w_tow: 2.0             # tow width (mm)
    - h_tow: 0.182           # tow thicknest (mm)
    - L_pro: caso[4]         # programmed gap (mm)
    - n_tows: 1.0            # number of tows
    - tipo_fallo: 'N'        # type of failure ('N' --> no failure ; 'O' --> overlap ; 'G' --> gap)
    - n_elementos_gap: 3     # XY number of elements in the gaps
    - n_elementos_capa: 3    # Z number of elements for each layer
    - n_elementos_towsingap: 100
    - angulos_tows: [caso[0], caso[1], caso[2], caso[3]]	# orientation of the layers (Y==0 degrees)
    - n_capas: len(angulos_tows)
    - Lset: 1                # longitud del set (mm)
    - distancia_fallo: 0     # failure (gap/overlap) lenght (mm)
    - ajus_ol: 5/6           # failure propagation through thickness (expected numer of layers/real number of layers)
    - ol_izd: 0.6            # failure transition (X negative)
    - ol_drch: 0.6           # failure transition (X positive)
    - AlyaSet: None          # If AlyaSet = 'All' --> only one set of the total RVE. Else, smaller sets.
    - debug: False           # True or False
    - queue: 'debug'         # ?¿
    - numCPUs: 64            # number of cpus for each simulation

